프로젝트 분석 내용:


   * `GameManager`가 게임의 전반적인 상태(시간, 플레이어 생존 여부, 레벨, 경험치 등)를 관리하는 중앙 허브 역할을 합니다.
   * `spawner`는 spawnPoint를 사용해 맵 곳곳에 몬스터를 생성하며, SpawnData에 설정된 가중치에 따라 다양한 종류의 몬스터를
     소환하는 시스템을 갖추고 있습니다.
   * `PoolManager`를 활용하여 몬스터와 발사체(Bullet) 같은 오브젝트를 재사용함으로써 성능을 최적화하고 있습니다.
   * `player`는 플레이어의 움직임과 애니메이션을 제어하고, `weapon` 스크립트는 마우스 방향에 따라 근접 또는 원거리 공격을
     수행합니다.
   * `Scaner`는 주변의 적을 감지하여 가장 가까운 대상을 찾아내는 역할을 합니다.

  몬스터 구현 분석:


   1. 기본 추적형 몬스터 (`Enemy.cs`):
       * 단순히 플레이어(target)를 향해 지정된 속도로 따라오는 기본적인 행동 패턴을 가집니다.
       * 총알(Bullet)에 맞으면 hp_reduce 함수를 통해 체력이 감소하고, 체력이 0이 되면 Dead 함수를 호출하여 비활성화됩니다.


   2. 특수 패턴형 몬스터 (`BombCrab.cs`, `DrillCrab.cs`):
       * Enemy.cs를 상속받지 않고, 독자적인 행동 로직을 가집니다.
       * `BombCrab`: 플레이어를 추적하다가 공격 범위 내에 들어오면, 잠시 멈춰 준비 자세를 취한 뒤 플레이어 위치에 폭탄을
         던지는 복합적인 행동 패턴을 보입니다.
       * `DrillCrab`: 플레이어를 감지하면 돌진 경로를 WarningLine으로 먼저 보여주어 공격을 예고하고, 잠시 후 해당 방향으로
         빠르게 돌진합니다.
       * 두 몬스터 모두 Chasing, Charging, Attacking 등 상태 머신(State Machine)을 기반으로 구현되어 있어 훨씬 다채롭고 예측
         가능한 공격 패턴을 만들어냅니다.


  요약하자면, 단순한 추적형 몬스터부터 복잡한 패턴을 가진 특수 몬스터까지 구현되어 있는 상황으로 이해했습니다.


  제가 이해한 내용이 맞나요? 이제 몬스터 제작과 관련하여 제가 도와드릴 부분이 있다면 편하게 말씀해주세요. 새로운 몬스터의
  기획이나 코드 구현, 기존 몬스터의 문제 해결 등 어떤 것이든 좋습니다.

╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│  > 맞아 나는 BombCrab:폭탄을 던져서 폭발시키는 몬스터, DrillCrab:드릴로 변신해서 플레이어의 위치를 추적해서 돌진하는   │
│    몬스터가 맞아                                                                                                       │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

✦ 네, 정확히 이해했습니다. BombCrab과 DrillCrab의 특징적인 공격 패턴까지 잘 파악하고 있습니다.


  이제 두 몬스터의 구현을 완료하셨거나 혹은 진행 중이신 것 같습니다. 다음으로 어떤 작업을 계획하고 계신가요? 예를 들어,


   * 새로운 종류의 몬스터를 추가하고 싶으신가요?
   * 기존 몬스터의 행동 패턴을 수정하거나 개선하고 싶으신가요?
   * 혹은 다른 궁금한 점이나 해결하고 싶은 문제가 있으신가요?


  말씀해주시면 바로 도와드리겠습니다.

╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│  > 우선 여기서 나는 스폰율을 수정하고자 해 Spawner 코드를 한번 봐볼래? 통일된 스폰율이 있고 각자의 가중치를 부여해서   │
│    또다른 스폰율을 만들어버렸어                                                                                        │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

✦ 네, spawner.cs 코드를 다시 살펴보겠습니다.

  말씀하신 대로 현재 스폰 시스템은 두 가지 요소로 구성되어 있습니다.


   1. 전체 스폰 주기 (`spawnRate`):
       * Update() 함수 안에서 timer > spawnRate 조건으로 사용됩니다.
       * 현재 0.8f로 설정되어 있어, 0.8초마다 한 번씩 몬스터를 생성하는 역할을 합니다. 즉, '얼마나 자주' 몬스터가 스폰될지를
         결정하는 전역 설정값입니다.


   2. 개별 스폰 가중치 (`spawnData`의 `weight`):
       * Spawn() 함수가 호출될 때, GetRandomPoolIndex() 안에서 사용됩니다.
       * 어떤 종류의 몬스터가 스폰될지를 확률적으로 결정합니다. 가중치(weight)가 높은 몬스터가 다른 몬스터보다 더 자주
         선택됩니다. 즉, '어떤' 몬스터가 스폰될지를 결정합니다.


  정리하자면, "0.8초마다(`spawnRate`) 몬스터가 한 마리 스폰되는데, 그 몬스터의 종류는 `spawnData`의 가중치(`weight`)에 따라 
  결정된다" 라고 할 수 있습니다.


  "통일된 스폰율이 있고 각자의 가중치를 부여해서 또다른 스폰율을 만들어버렸다"라고 정확하게 파악하셨습니다. 이 구조가
  의도하신 바와 다르거나 수정하고 싶으신 부분이 있으신가요?

  예를 들어, 어떤 방향으로 수정을 원하시는지 알려주시면 더 구체적인 도움을 드릴 수 있습니다.


   * 게임 시간에 따라 전체 스폰 주기를 바꾸고 싶으신가요? (예: 시간이 지날수록 spawnRate 감소)
   * 특정 몬스터만 독립적인 주기로 스폰되게 하고 싶으신가요?
   * 현재 구조는 유지하되, 단순히 `spawnRate`나 `weight` 값을 조정하고 싶으신가요?

╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│  > 너는 어떻게 했으면 좋겠어? 뱀서라이크류는 특수 공격을 하는 몹을 따로 스폰율을 생성하나? 아니면 그냥 동일하게 스폰율을   │
│    적용하나 ?                                                                                                              │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

✦ 좋은 질문입니다. 뱀서라이크 장르에서 몬스터 스폰 방식은 게임의 난이도와 흐름을 결정하는 매우 중요한 요소입니다.

  일반적으로 두 가지 접근 방식이 많이 사용됩니다.


   1. 통합 스폰 시스템 (현재 방식):
       * 모든 몬스터를 하나의 스포너가 관리하며, 가중치를 통해 희귀도를 조절합니다.
       * 장점: 구현이 간단하고, 전체적인 몬스터 밀도를 spawnRate 하나로 조절하기 쉽습니다.
       * 단점: 특수 몬스터의 등장 시점을 정확하게 제어하기 어렵습니다. 순전히 확률에 의존하기 때문에, 운이 나쁘면 초반에 특수
         몬스터가 몰려나와 난이도가 급상승하거나, 혹은 너무 안 나와서 게임이 단조로워질 수 있습니다.


   2. 분리된 스폰 시스템 (추천 방식):
       * 일반 몬스터용 스포너와 특수/엘리트 몬스터용 스포너를 따로 둡니다.
       * 예를 들어, 일반 몬스터는 지금처럼 0.8초마다 계속 스폰시키고, BombCrab이나 DrillCrab 같은 특수 몬스터는 별도의
         타이머를 두어 "15초마다 한 마리씩" 등장시키는 방식입니다.
       * 장점: 게임의 흐름을 정교하게 설계할 수 있습니다. "1분쯤부터는 BombCrab이 나오기 시작하고, 3분부터는 DrillCrab이
         10초에 한 번씩 나온다" 와 같이 의도적으로 난이도를 조절하고 긴장감을 부여할 수 있습니다. 이는 뱀서라이크 장르의 핵심
         재미 요소 중 하나입니다.
       * 단점: 구현이 약간 더 복잡해집니다.

  결론 및 추천:


  저는 2번, 분리된 스폰 시스템을 사용하는 것을 추천합니다.


  BombCrab과 DrillCrab은 일반 몬스터와는 다른 특별한 공격 패턴을 가지고 있으므로, 이들의 등장은 플레이어에게 확실한 위협이자
  도전 과제가 되어야 합니다. 이들을 별도의 타이머로 관리하면 게임의 난이도 곡선을 훨씬 더 안정적이고 재미있게 만들 수
  있습니다.

  구체적인 구현 방법 제안:


   * 현재의 spawner.cs는 일반 추적형 몬스터(Enemy.cs)들만 스폰하도록 둡니다.
   * 그리고 GameManager.cs에 게임 시간에 맞춰 특수 몬스터를 스폰하는 로직을 추가하는 겁니다. 예를 들어, 게임 시간이 30초가
     지날 때마다 BombCrab을 한 마리 스폰하는 식이죠.


  이 방식에 동의하시면, GameManager.cs에 특수 몬스터 스폰 로직을 추가하는 작업을 함께 진행해 볼 수 있습니다. 어떻게
  생각하시나요?

---
### DrillCrab 버그 수정 기록 (2025-09-26)

**문제 상황 요약:**
- `Spawner`와 `PoolManager`를 통해 동적으로 생성된 `DrillCrab`이 돌진 패턴을 정상적으로 사용하지 못하는 문제 발생.
- (초기 보고) '돌진 준비' 동작 후 제자리에서 멈춤.
- (상세 보고) '돌진 준비' 후, 전진하지 않고 제자리에서 공격 애니메이션만 반복하는 현상.
- 씬에 수동으로 `DrillCrab` 프리팹을 배치하고 실행하면 모든 기능이 정상 작동하여, 풀링(Pooling) 과정에서의 상태 초기화 문제로 추정됨.

**시도한 해결책 및 결과:**
1.  **물리 상태 명시적 설정:** `OnEnable`에서 Rigidbody의 `bodyType`을 `Dynamic`으로 강제 설정. -> **실패.**
2.  **충돌 해결:** 돌진 시 `isTrigger`를 `true`로 변경하여 다른 몬스터를 통과하도록 수정. -> **실패.** (돌진 자체가 발동하지 않음)
3.  **애니메이터-물리 충돌 가설:** 돌진하는 동안 `Animator` 컴포넌트를 비활성화하여 물리 제어 독점. -> **실패.**
4.  **부모-자식 관계 가설:** `PoolManager`가 몬스터를 자식으로 두는 것이 문제일 것으로 추정, 스폰 시 부모 관계를 해제하도록 수정. -> **실패.**

**현재 상태 및 다음 단계 (2025-09-26 중단 시점):**
- **결론:** 위의 모든 시도가 실패함에 따라, 가장 기본적인 '플레이어 감지' 단계부터 문제가 발생하고 있을 가능성 제기. (`ChargeAndDash` 코루틴이 아예 시작되지 않음)
- **조치:** 원인 분석을 위해 `DrillCrab.cs`의 `Update()` 함수에 1초마다 플레이어와의 거리(`distance`), 감지 반경(`detectionRadius`), 감지 상태(`isPlayerInRange`)를 콘솔에 출력하는 디버그 로그를 추가함.
- **다음 할 일:** 게임을 실행하여 `Update` 로그를 확인하고, 플레이어 감지 로직이 정상적으로 작동하는지, `isPlayerInRange` 값이 올바르게 변경되는지 분석하여 근본 원인 파악 필요.
---

---
### `DrillCrab` 및 스폰 시스템 버그 수정 (2025-10-15)

**문제 상황 요약:**
- `EnemyStats.cs` 도입 이후, `spawner`가 `DrillCrab`을 포함한 모든 몬스터 및 `Mine` 오브젝트를 스폰하지 못하는 문제 발생.

**원인 분석:**
1.  **`EnemyStats.cs`의 `Awake()` 에러**: `Status` 타입의 변수(`speedPoint` 등)가 Inspector에서 할당되지 않은 `null` 상태일 때, `Awake()` 함수에서 해당 변수의 내부 값에 접근하려다 `NullReferenceException` 발생.
2.  **`Instantiate` 실패 및 연쇄 중단**: 이 `Awake()` 에러가 `PoolManager`가 `Instantiate()` 함수를 호출하는 과정에서 발생하여, 오브젝트 생성 자체가 실패함. 이로 인해 `PoolManager`가 `null`을 반환하고, 전체 스폰 프로세스가 중단됨.

**해결 과정:**
11. **`EnemyStats.cs` 수정**: `Awake()` 함수에 `Status` 변수들이 `null`일 경우 `new Status()`로 새로 생성해주는 방어 코드를 추가하여, `Instantiate`가 항상 성공하도록 수정함. (스폰 문제 해결)
12. **`DrillCrab` 동작 개선**:
    - **문제**: 스폰 후 제자리에 멈춰있는 문제 발생. `OnEnable()`에서 `EnemyStats.Awake()`보다 먼저 `target` 정보를 가져오려던 실행 순서 문제로 확인됨.
    - **수정**: `target`을 가져오는 로직을 `OnEnable()`에서, 모든 `Awake()`가 끝난 후 실행되는 것이 보장되는 `Start()` 함수로 이동하여 해결.
    - **개선**: 게임 디자인을 고려하여, 제자리에 대기하던 패턴을 '플레이어를 추적하다가 범위 내에 들어오면 돌진하는' `BombCrab`과 유사한 패턴으로 변경하여 역동성을 높임.

**결과:**
- 스폰 시스템이 정상적으로 동작하여 모든 몬스터가 다시 씬에 나타남.
- `DrillCrab`이 플레이어를 추적하고, 근접 시 돌진 공격을 시도하도록 수정됨.

---
### `DrillCrab` 최종 디버깅 및 코드 정리 (2025-10-15)

**문제 상황 요약:**
- 모든 코드 수정 및 프리팹 재구성 이후에도 `DrillCrab`이 추적, 경고선 표시 등 핵심 기능을 수행하지 못하는 문제 지속.

**진짜 근본 원인 발견:**
- 사용자로부터 "Creating missing EnemyStats component..." 로그 메시지에 대한 정보를 얻음.
- 이를 통해, `Enemy` 또는 `DrillCrab` 프리팹에 `EnemyStats` 컴포넌트가 없어, `[RequireComponent]` 속성에 의해 게임 실행 시 **모든 값이 비어있는 새로운 `EnemyStats` 컴포넌트가 강제로 추가**되고 있었음을 발견.
- 이것이 Inspector에서 `Speed` 값을 아무리 수정해도 적용되지 않았던 현상의 원인이었음.
- **최종 해결책:** 사용자가 직접 모든 적 프리팹(`Enemy A`, `B`, `DrillCrab` 등)을 확인하고, `EnemyStats` 컴포넌트를 수동으로 추가 및 설정해야 함.

**추가 코드 수정 및 개선:**
- **상태 변경 문제 해결:** `DrillCrab`이 추적을 멈추지 않고 돌진하던 문제를 해결하기 위해, 상태(State)를 먼저 변경한 후 코루틴을 호출하도록 수정.
- **애니메이션 제어 방식 개선:** `IsChasing` (Bool) 파라미터 방식의 문제점을 인지하고, 애니메이션의 재생 속도(Speed)를 제어하는 `ChaseSpeed` (Float) 파라미터 방식으로 코드를 리팩토링함. 이를 통해 '걷기'가 기본 자세인 애니메이터 구조에 더 잘 맞고, 돌진 중 `Crab_Loop` 애니메이션도 정상 작동하도록 개선.
- **Obsolete 코드 수정:** Unity에서 경고를 표시하는 `rb.velocity`를 권장 방식인 `rb.linearVelocity`로 모두 교체.

**최종 상태 (현재):**
- 모든 스크립트 코드는 여러 버그가 수정되고 로직이 개선된 최종적인 상태임.
- 하지만 사용자는 여전히 추적 및 경고선 기능이 작동하지 않는다고 보고함. 이는 코드 외부, 즉 Unity 에디터 설정에 아직 해결되지 않은 문제가 남아있음을 시사함.

---
### 작업 기록 (2025-10-16)

**`DrillCrab` (`Enemy B`) 문제 해결 및 개선:**

- **방향 전환 문제:** 돌진 및 추적 시 스프라이트의 방향이 반대로 보이던 문제를 `direction.x > 0` 조건으로 수정하여 해결.
- **경고선 미표시 문제:**
    - `LineRenderer`가 월드 좌표를 사용하여 맵 중앙에 그려지던 문제를, `useWorldSpace = false`로 설정하여 로컬 좌표 기준으로 작동하도록 수정.
    - `LineRenderer`의 너비와 위치값이 없어 선이 보이지 않을 가능성을 차단하기 위해, 코드에서 강제로 기본값(너비 0.1, 길이 10)을 설정하도록 보강.
- **경고선 잔해 문제:** `DrillCrab`이 공격 준비 중에 죽었을 때 경고선이 맵에 그대로 남는 문제를 해결. 경고선이 자신의 부모(`DrillCrab`)가 사라졌는지 스스로 확인하고 파괴하는 '자폭' 기능을 구현.
- **물리 문제 개선:**
    - 정지 상태에서 다른 오브젝트에 의해 쉽게 밀리거나, 밀렸을 때 미끄러지는 현상을 개선.
    - `Kinematic` 방식이 플레이어의 길을 막는 문제를 해결하기 위해, 정지 시 `Rigidbody2D`의 `mass`를 일시적으로 크게 높여 저항감을 주는 '무거운 물체' 방식으로 변경.
    - Unity 최신 버전에 맞춰, 사용되지 않는 `drag` 속성을 `linearDamping`으로 교체.

**`BombCrab` (`Enemy C`) 리팩토링:**

- `BombCrab.cs`가 `DrillCrab`처럼 `EnemyStats` 컴포넌트를 사용하도록 구조를 변경.
- 이를 통해 속도, 체력 등의 스탯을 `EnemyStats`에서 일관되게 관리할 수 있게 됨.
- (사용자 작업) `Enemy C` 프리팹에 `EnemyStats` 컴포넌트 추가 및 `Speed Point` 값(`30`) 설정 필요.

**폭발 시스템 통일:**

- **목표:** `BombCrab`의 폭탄과 `Mine`이 메모리 절약을 위해 동일한 폭발 이펙트를 공유하도록 시스템 통일.
- **`Explosion.cs` 생성:** 폭발 애니메이션 재생 후 스스로 풀로 돌아가는 재사용 가능한 공용 스크립트 생성.
- **`PoolManager` 활용:** 사용자가 `ExplosionPrefab`을 생성하여 `PoolManager`의 7번 인덱스에 등록.
- **`Bomb.cs` 및 `Mine.cs` 수정:** 두 스크립트 모두 각자의 폭발 로직 대신, `PoolManager`의 7번 `ExplosionPrefab`을 가져와 사용하도록 수정 완료.

**기타:**

- **물리 레이어 설정:** 적들끼리 서로 충돌하지 않도록 `Physics 2D`의 레이어 충돌 매트릭스 설정을 안내.
- **테스트 지원:** `BombCrab`의 폭탄이 테스트에 방해되지 않도록 플레이어에게 데미지를 주는 기능을 임시로 비활성화.

---
### `ShootingFish` (`Enemy D`) 신규 몬스터 기획

- **컨셉:** 쏠배감팽. 플레이어 근처로 다가와 부채꼴 형태로 가시를 발사하는 원거리 몬스터.
- **공격 방식:**
    - 유도 기능은 없음. 가시는 직선으로만 날아감.
    - 한 번에 여러 발의 가시(`spineCount`)를 지정된 각도(`spreadAngle`)로 발사.
- **행동 패턴:**
    - `Chasing`: 평소에는 플레이어를 따라다님.
    - `Attacking`: 플레이어가 공격 범위(`attackRange`) 내에 들어오면, 제자리에 멈춰서 가시를 발사.
    - `Cooldown`: 공격 후 잠시 대기.
- **구현 계획:**
    1.  **`Spine.cs` 생성:** 가시 투사체를 위한 스크립트. 직선으로 날아가고 플레이어에게 닿으면 데미지를 주고 사라짐.
    2.  **`ShootingFish.cs` 생성:** `EnemyStats`를 기반으로 작동하며, `Chasing`, `Attacking`, `Cooldown` 상태를 가지는 메인 스크립트.
    3.  **프리팹 제작 및 연결 (사용자 작업):**
        - `SpinePrefab` (가시)과 `EnemyDPrefab` (몬스터 본체) 제작.
        - 두 프리팹을 `PoolManager`에 등록.
        - `EnemyDPrefab`의 `ShootingFish.cs`에 `SpinePrefab`의 Pool Index를 연결.
        - `Spawner`에 `EnemyDPrefab`을 등록하여 게임에 등장시킴.
---
### 이펙트 시스템 개선 (2025-11-07)

#### 1. `BombCrab` 경고 이펙트 개선

**목표:** `BombCrab`의 폭탄 경고 효과를 기존의 '원 확대' 방식에서, '색상 채우기'(Radial Fill) 방식으로 변경하여 시각적 표현을 개선.

**진행 과정:**
- **`Bomb.cs` 리팩토링:** `transform.localScale` 대신 `MaterialPropertyBlock`을 사용하여 셰이더의 `_FillAmount` 속성을 제어하도록 변경.
- **`RadialFill.shader` 작성:** `_FillAmount` 값에 따라 스프라이트를 방사형으로 채우는 커스텀 셰이더를 작성하여 `Assets/Galapagos/Shader/` 폴더에 저장.
- **에디터 설정 및 문제 해결:** `RadialFill.shader`를 사용하는 재질(`BombWarning_Mat`)을 생성하고 프리팹에 적용하도록 안내. 이 과정에서 `Order in Layer`를 이용한 렌더링 순서 문제와 `explosionRadius`를 통한 범위 조절 방법을 함께 해결.

**결과:** `BombCrab`의 폭탄 경고가 외곽선 내에서 색상이 차오르는 방식으로 성공적으로 구현됨.

#### 2. `WarningLine` (DrillCrab) 경고 이펙트 개선

**목표:** `DrillCrab`이 사용하는 `WarningLine` 경고 효과를 '색상이 길이 방향으로 채워지는' 방식으로 개선하여, `BombCrab`의 경고 효과와 통일성을 부여.

**진행 과정:**
- **`LineFill.shader` 작성:** `LineRenderer` 전용 커스텀 셰이더를 `Assets/Galapagos/Shader/` 폴더에 생성. `_FillAmount` 속성을 이용해 선의 길이 방향으로 채워지는 효과를 구현.
- **`WarningLineEffect.cs` 리팩토링:** 매 프레임 `Gradient`를 생성하던 비효율적 로직을 제거하고, `MaterialPropertyBlock`을 사용해 `_FillAmount` 속성을 변경하는 효율적인 코드로 현대화.
- **에디터 설정 안내:** `LineFill.shader`를 사용하는 재질(`WarningLine_Mat`)을 생성하여 `WarningLine.prefab`의 `LineRenderer`에 적용하도록 안내.

**결과:** `DrillCrab`의 돌진 경고선이 시작 지점부터 끝 지점까지 점차 색상으로 채워지는 방식으로 변경되어, 게임의 전반적인 경고 효과 스타일이 통일됨.
---
### `BombCrab` 폭탄 효과 개선 (2025-11-09)

**목표:** `BombCrab`이 던지는 폭탄(`Crab_Bomb`)이 땅에 착지했을 때, 물에 반쯤 잠겨 둥둥 뜨는 듯한 시각적 효과를 추가하여 게임의 디테일을 향상.

**구현 내용:**

1.  **'반쯤 잠긴' 시각 효과 구현:**
    *   **`SpriteMask` 활용:** 폭탄 프리팹(`Crab_Bomb`) 내부에 `SpriteMask`를 추가하여, 착지 시 폭탄 스프라이트의 하단 절반을 가리는 방식으로 구현.
    *   **`maskInteraction` 코드 제어:** 비행 중에는 애니메이션이 정상적으로 보이도록 `SpriteRenderer`의 `maskInteraction` 속성을 코드로 `None`(마스크 무시)으로 설정하고, 착지 후에만 `VisibleInsideMask`로 변경하여 마스크 효과가 적용되도록 함. 이 과정에서 발생했던 '비행 애니메이션 스킵' 문제를 해결.

2.  **'둥둥 뜨는' 애니메이션 효과 구현:**
    *   **`BobbingEffect` 코루틴 추가:** `Bomb.cs`에 새로운 코루틴을 추가하여, `Mathf.Sin` 함수를 이용해 `SpriteMask`의 위치를 주기적으로 위아래로 움직이는 로직을 구현.
    *   **동시 실행 로직:** 폭탄 착지 후, 기존의 '폭발 경고'(`ExplosionSequence`)와 새로운 '둥둥 뜨는 효과'(`BobbingEffect`)가 **동시에 시작**되도록 수정. 이를 통해 착지 후 불필요한 대기 시간을 없애고, 경고 타이머가 진행되는 동안 자연스럽게 둥둥 뜨는 모습을 연출.
    *   **인스펙터 변수 추가:** 둥둥 뜨는 효과의 속도(`bobbingSpeed`)와 높이(`bobbingHeight`)를 Unity 인스펙터에서 쉽게 조절할 수 있도록 변수화.

**결과:**
- `Crab_Bomb`이 착지 시, 비행 애니메이션이 정상적으로 재생된 후 반쯤 잠긴 모습으로 변함.
- 폭발 전 경고가 표시되는 동안, 물결에 따라 위아래로 자연스럽게 흔들리는 애니메이션이 추가되어 시각적 완성도가 높아짐.
---
### `BombCrab` 피격 로직 및 `weapon.cs` 컴파일 오류 해결 (2025-11-26)

**문제 상황 요약:**
*   `BombCrab` 프리팹에 `Enemy.cs`와 `BombCrab.cs`가 모두 붙어 있어 피격 효과가 중복 적용됨.
*   총알 충돌 시 피격 효과 및 대미지가 이중으로 적용되는 문제가 발생함.
*   `weapon.cs`에서 `BombCrab.OnHit()`을 호출하는 로직이 있었으나, `BombCrab.cs`에서 `OnHit` 메서드를 제거한 후 `CS1061: 'BombCrab' does not contain a definition for 'OnHit'` 컴파일 오류 발생.
*   `DrillCrab`이 플레이어에게 밀렸을 때 빙판처럼 미끄러지는 물리적 문제 발생.

**원인 분석:**
*   **피격 효과 중복 및 컴파일 오류:** `BombCrab.cs`가 `Enemy.cs`와 같은 GameObject에 존재하면서 피격 처리 로직을 공유/위임하는 명확한 구조가 없어 충돌 발생.
*   **`DrillCrab` 미끄러짐:** `DrillCrab.cs`의 `Rigidbody2D` `linearDamping` (선형 저항) 값이 너무 낮거나 기본 설정이 없어 외부 힘에 쉽게 미끄러지는 문제.

**해결 과정:**
1.  **`BombCrab.cs` 수정 (피격 로직 위임):**
    *   `BombCrab.cs`에서 자체적인 `isKnockback` 변수, `OnHit()` 메서드, `Knockback()`/`HitEffect()` 코루틴 및 관련 변수와 `[Header("피격 효과")]` 속성을 모두 제거하여 `Enemy.cs`와 중복되는 피격 관련 로직을 삭제함.
    *   `BombCrab.cs`에 `private Enemy enemy;` 변수를 추가하고 `Awake()`에서 `GetComponent<Enemy>()`로 초기화함.
    *   `weapon.cs`의 컴파일 오류 해결을 위해, `BombCrab.cs`에 `public void OnHit(float damage)` 메서드를 다시 추가하되, 이 메서드 내부에서는 `enemy?.OnHit(damage);`를 호출하여 모든 피격 처리를 `Enemy.cs`에 위임하도록 함.
    *   총알 피격 시 중복 처리를 방지하기 위해 `BombCrab.cs` 내의 `OnTriggerEnter2D` 메서드를 삭제함.
    *   클래스 선언부의 중복 `[RequireComponent(typeof(EnemyStats))]` 속성 하나를 제거하여 코드를 정리함.

2.  **`DrillCrab.cs` 수정 (물리 미끄러짐 해결):**
    *   `DrillCrab.cs`의 `Awake()` 메서드에서 `Rigidbody2D`의 `linearDamping` 값이 `0.1f` 미만일 경우 `5f`로 강제 설정하여, 물리적으로 밀려난 후에도 적절한 마찰력으로 멈출 수 있도록 안전 장치를 추가함.
    *   클래스 선언부의 중복 `[RequireComponent(typeof(EnemyStats))]` 속성 하나를 제거하여 코드를 정리함.

**결과:**
*   `BombCrab`의 피격 효과 중복 문제가 해결되었고, `weapon.cs`의 컴파일 오류도 해소됨.
*   `DrillCrab`이 플레이어에게 밀렸을 때 더 이상 빙판처럼 미끄러지지 않고 자연스럽게 정지함.
*   `BombCrab.cs`와 `DrillCrab.cs` 모두 `Enemy.cs`와 공통되는 `RequireComponent` 속성 중복이 정리되어 코드가 깔끔해짐.
---
### 몬스터 사망 효과 및 경험치 구슬 드랍 구현 (2025-11-27)

**진행 상황:**
- 몬스터(`Enemy A, B, C, D`) 사망 시 애니메이션 재생 및 경험치 구슬 드랍 기능을 구현 중.
- `EnemyStats.cs` 수정 완료: `DeadCo()` 코루틴에서 사망 시 애니메이션 트리거, 경험치 구슬 생성 로직 포함.
- `Gem.cs` 및 `Gem.prefab` 임시 파일 생성 완료.

**남은 문제 및 해결 방안 (일시 중단):**
- **문제**: 일부 몬스터(`BombCrab`, `DrillCrab` 등)의 크기가 커서, 사망 애니메이션이 해당 몬스터의 크기에 비례하여 너무 크게 보이는 문제 발생.
- **원인 분석**: `Animator`에서 재생되는 애니메이션 클립이 몬스터의 `transform.localScale`에 영향을 받아 크기가 함께 커지는 것으로 추정.
- **제안된 해결책 (미적용)**: `EnemyStats.cs`의 `DeadCo()` 코루틴을 수정하여, 사망 이펙트 프리팹을 생성한 후 애니메이션이 재생되는 1초 동안 **매 프레임마다** 해당 이펙트의 `localScale` 값을 `deathEffectScale` 변수에 따라 강제로 고정시키는 코드 변경안이 제안됨. 이 방식은 애니메이션 클립 내의 크기 조절을 무시하고 스크립트에서 원하는 크기를 유지하는 방법.
- **현재**: 사용자 요청으로 위 코드 변경은 잠시 보류되었으며, 내일 이어서 작업 예정.